# .envrc - Don't create competing venvs
is_nixos() {
    [[ -f /etc/NIXOS ]] || [[ -d /nix/store && -n "$NIX_PATH" ]]
}

if is_nixos; then
    use flake
    export UV_PYTHON_PREFERENCE=system
    export UV_PYTHON=$(which python3)
fi

# Don't use layout python3 - let uv handle the venv
PATH_add scripts/

# Sync dependencies (this creates .venv)
if [[ -f pyproject.toml ]] && command -v uv >/dev/null 2>&1; then
    uv sync --quiet >/dev/null 2>&1
fi

echo "âœ… AM215 environment ready"
echo "ðŸ’¡ Use 'uv run jupyter-book build .' to build"
